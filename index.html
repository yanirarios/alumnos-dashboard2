<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>EduManager ‚Äî Gesti√≥n de Alumnos (con sync)</title>
<style>
  :root{ --bg:#fff0f6; --accent:#d96b8a; --accent-dark:#c45878; --muted:#ffdce6; --card:#fff; --chip:#ffb6d9; --text:#5a2b39; --soft:#fff7fb; }
  *{box-sizing:border-box}
  body{ margin:0; font-family:Arial, Helvetica, sans-serif; background:linear-gradient(180deg,var(--bg),#fff6f9 60%); color:var(--text); min-height:100vh; display:flex; }
  .sidebar{ width:220px; background:var(--accent); color:#fff; padding:24px; display:flex; flex-direction:column; gap:14px; min-height:100vh }
  .brand{ font-weight:700; font-size:20px; text-align:center }
  .nav a{ display:flex; gap:10px; align-items:center; padding:10px 12px; border-radius:10px; text-decoration:none; color:inherit }
  .nav a:hover{ background:rgba(255,255,255,0.08) }
  .main{ flex:1; padding:26px }
  h1{ margin:0 0 12px 0; color:var(--accent-dark) }
  .toolbar{ display:flex; gap:10px; align-items:center; margin-bottom:14px; flex-wrap:wrap }
  .search{ flex:1; display:flex }
  .search input{ width:100%; padding:10px 12px; border-radius:10px; border:1px solid #ffd1e6; background:var(--soft) }
  .btn{ background:var(--accent); color:white; padding:10px 14px; border-radius:10px; border:none; cursor:pointer; font-weight:600 }
  .btn.ghost{ background:transparent; color:var(--accent-dark); border:1px solid #ffd1e6 }
  .card{ background:var(--card); padding:16px; border-radius:12px; box-shadow:0 6px 18px rgba(90,43,57,0.06) }
  table{ width:100%; border-collapse:collapse; margin-top:12px; border-radius:10px; overflow:hidden }
  thead th{ background:var(--muted); text-align:left; padding:12px; font-weight:700 }
  tbody td{ background:var(--soft); padding:12px; border-bottom:1px solid #ffd3e0; vertical-align:middle }
  .chip{ display:inline-block; background:var(--chip); color:var(--text); padding:6px 10px; border-radius:999px; margin:4px 6px 4px 0; font-size:13px }
  .chip .x{ margin-left:8px; font-weight:700; cursor:pointer; opacity:.7 }
  .muted{ color:#9b6a77; font-size:13px }
  /* modal */
  .modal-backdrop{ position:fixed; inset:0; background:rgba(0,0,0,0.35); display:flex; align-items:center; justify-content:center; z-index:1000 }
  .modal{ width:920px; max-width:96%; background:white; border-radius:12px; padding:18px }
  .field{ display:flex; flex-direction:column; margin-bottom:10px }
  .tags-input{ display:flex; gap:6px; flex-wrap:wrap; padding:8px; background:#fff7fb; border:1px solid #ffd1e6; border-radius:8px; min-height:44px; align-items:center }
  .tags-input input{ border:none; outline:none; padding:6px; min-width:120px }
  .suggestions{ position:relative }
  .suggest-box{ position:absolute; top:42px; left:0; right:0; background:white; border:1px solid #ffd1e6; border-radius:8px; max-height:150px; overflow:auto; z-index:10 }
  .suggest-item{ padding:8px; cursor:pointer }
  .suggest-item:hover{ background:#fff0f6 }
  .actions button{ margin-right:8px }
  @media (max-width:880px){ .sidebar{ display:none } .toolbar{ flex-direction:column; align-items:stretch } .modal{ width:95% } }
</style>
</head>
<body>

  <div class="sidebar">
    <div class="brand">EduManager</div>
    <nav class="nav">
      <a class="active" href="#">üè† Dashboard</a>
      <a href="#">üë• Alumnos</a>
      <a href="#">üìò Materias</a>
      <a href="#">‚öôÔ∏è Ajustes</a>
    </nav>
    <div style="margin-top:auto;font-size:13px;opacity:.9">
      <div class="muted">Usuario</div><div style="font-weight:600">Tu cuenta</div>
    </div>
  </div>

  <main class="main">
    <h1>Gesti√≥n de Alumnos</h1>

    <div class="toolbar">
      <div class="search"><input id="searchInput" placeholder="Buscar por nombre, materia o celular..." /></div>
      <button class="btn ghost" id="importBtn">Importar JSON</button>
      <button class="btn ghost" id="exportBtn">Exportar JSON</button>
      <button class="btn ghost" id="pullBtn" title="Bajar desde servidor (si est√° configurado)">Sincronizar ‚Üì</button>
      <button class="btn ghost" id="pushBtn" title="Subir al servidor (si est√° configurado)">Sincronizar ‚Üë</button>
      <button class="btn" id="openAddBtn">Agregar Alumno</button>
    </div>

    <div class="card">
      <div style="display:flex;gap:12px;align-items:center;margin-bottom:12px">
        <div style="font-weight:700">Lista de alumnos</div>
        <div class="muted">Cantidad: <span id="count">0</span></div>
      </div>

      <table id="studentsTable" class="table-sm" aria-label="Lista de alumnos">
        <thead>
          <tr>
            <th>Nombre</th><th>Materias</th><th>N√∫mero</th><th>Horario</th><th style="width:140px">Acciones</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>

    </div>
  </main>

  <div id="modalRoot" style="display:none"></div>

<script>
/* -------------------- CONFIGuraci√≥n SERVIDOR --------------------
  OPCI√ìN FIREBASE: pega tu firebaseConfig aqu√≠ (objeto).
  Si dejas 'firebaseConfig = null' la app usar√° localStorage solamente.
  Para usar Supabase o tu propio backend, implemento instrucciones abajo.
*/
const firebaseConfig = null;
/* Ejemplo (reemplaza con tu config real para activar):
const firebaseConfig = {
  apiKey: "xxx",
  authDomain: "xxx.firebaseapp.com",
  projectId: "xxx",
  storageBucket: "xxx.appspot.com",
  messagingSenderId: "xxx",
  appId: "xxx"
};
*/
/* ------------------------------------------------------------- */

const REFERENCE_VIDEO = "/mnt/data/EduManager - Gesti√≥n de Alumnos - Google Chrome 2025-11-24 11-11-14.mp4";

/* ---------- dependencias (si firebase est√° activado se cargar√°n) ---------- */
let firebaseApp = null, firestore = null;

/* ---------- Storage & helpers ---------- */
const LS_KEY = "edu_alumnos_v2";

function uid(){ return Date.now().toString(36) + Math.random().toString(36).slice(2,8) }

function loadStudents(){
  try{
    const raw = localStorage.getItem(LS_KEY);
    if(!raw) return [];
    return JSON.parse(raw);
  }catch(e){ console.error(e); return [];}
}
function saveStudents(arr){
  localStorage.setItem(LS_KEY, JSON.stringify(arr));
}

function phoneValid(v){
  if(!v) return false;
  const digits = v.replace(/\D/g,"");
  return digits.length>=7 && digits.length<=15;
}

/* ---------- state ---------- */
let students = loadStude
